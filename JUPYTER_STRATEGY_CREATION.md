# Jupyter 策略創建功能說明

## 功能概述

現在策略編輯器支援兩種創建模式：
1. **傳統編輯器模式** - 完整的策略程式碼編輯
2. **Jupyter 模式** - 互動式單元格編輯

## 新增策略流程

### 1. 選擇編輯模式

在新建策略對話框中，首先選擇編輯模式：

- **傳統編輯器**：適用於完整的策略程式碼開發
- **Jupyter 模式**：適用於互動式策略開發和資料分析

### 2. 選擇策略類型

#### 傳統編輯器模式下的策略類型：
- **向量化模板**：效能最佳，適用於簡單邏輯
- **狀態機模板**：適用於複雜邏輯和狀態追蹤
- **混合模式模板**：包含向量化和狀態機兩種模式
- **空白策略**：從零開始建立

#### Jupyter 模式下的策略類型：
- **向量化策略**：一次性計算所有信號
- **狀態機策略**：逐筆處理，追蹤狀態
- **混合策略**：結合向量化和狀態機優勢
- **分析模式**：純資料分析，無交易邏輯

## Jupyter 策略類型詳解

### 1. 向量化策略 (Vectorized Strategy)

**特點：**
- 一次性處理所有資料
- 使用 NumPy/Pandas 向量化運算
- 效能最佳，適合大量資料處理

**適用場景：**
- 簡單的技術指標策略
- 基於統計的量化策略
- 需要快速回測的策略

**範例功能：**
- 移動平均交叉信號
- RSI 超買超賣信號
- 布林通道突破信號
- 綜合信號生成

### 2. 狀態機策略 (State Machine Strategy)

**特點：**
- 逐筆處理資料
- 追蹤交易狀態
- 支援複雜的進出場邏輯

**適用場景：**
- 複雜的交易邏輯
- 需要狀態追蹤的策略
- 基於事件驅動的策略

**範例功能：**
- 狀態機邏輯實作
- 進出場條件判斷
- 交易記錄追蹤
- 績效分析

### 3. 混合策略 (Hybrid Strategy)

**特點：**
- 結合向量化和狀態機優勢
- 向量化計算技術指標
- 狀態機過濾和優化信號

**適用場景：**
- 需要複雜信號過濾的策略
- 多指標組合策略
- 需要趨勢確認的策略

**範例功能：**
- 向量化信號生成
- 狀態機信號過濾
- 多重確認機制
- 止損止盈邏輯

### 4. 分析模式 (Analysis Mode)

**特點：**
- 純資料分析
- 無交易邏輯
- 專注於資料探索和視覺化

**適用場景：**
- 資料探索和分析
- 策略研究和開發
- 市場研究

**範例功能：**
- 基本統計分析
- 技術指標計算
- 價格走勢分析
- 報酬率分析

## 使用流程

### 1. 創建 Jupyter 策略

1. 點擊「新建策略」按鈕
2. 選擇「Jupyter 模式」
3. 選擇策略類型（向量化/狀態機/混合/分析）
4. 輸入策略名稱和描述
5. 點擊「建立」

### 2. 編輯 Jupyter 策略

1. 系統自動切換到 Jupyter 模式
2. 載入對應類型的範例程式碼
3. 使用單元格編輯器修改程式碼
4. 按 Shift+Enter 執行單元格
5. 按 Ctrl+Enter 執行並新增單元格

### 3. 載入現有策略

1. 從策略列表選擇策略
2. 系統自動檢測編輯模式
3. Jupyter 策略自動切換到 Jupyter 模式
4. 傳統策略使用傳統編輯器

## 技術實現

### 後端支援

1. **策略管理器擴展**：
   - 支援 `editor_mode` 和 `jupyter_strategy_type` 欄位
   - 根據編輯模式載入不同模板

2. **Jupyter API**：
   - `/api/jupyter/execute` - 執行程式碼
   - `/api/jupyter/sample-data` - 載入範例資料

### 前端實現

1. **編輯模式切換**：
   - 動態顯示/隱藏策略類型選項
   - 根據選擇載入對應模板

2. **Jupyter 編輯器**：
   - 多單元格編輯
   - 即時程式碼執行
   - 多種輸出格式支援

## 注意事項

1. **模式切換**：創建後無法更改編輯模式
2. **策略類型**：Jupyter 策略類型僅影響初始模板
3. **程式碼執行**：Jupyter 模式下的程式碼在後端安全環境中執行
4. **資料載入**：支援載入範例資料進行測試

## 未來擴展

1. **更多策略類型**：支援更多專業策略模板
2. **互動式圖表**：支援 Plotly 等互動式圖表
3. **策略分享**：支援 Jupyter 筆記本匯出/匯入
4. **協作功能**：支援多人協作編輯 